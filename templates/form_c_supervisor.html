<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Form C – Researcher's Details | JBS Ethics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/form_a.css" />
  <!-- <link rel="stylesheet" href="{{ url_for('static', filename='css/form_a.css') }}"> -->

    <style>
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.6);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: #fff;
      padding: 2rem;
      border-radius: 8px;
      text-align: center;
      width: 400px;
      max-width: 90%;
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
    }

    .modal-content h3 {
      margin-bottom: 1rem;
      color: #2E1A46;
    }

    .modal-content button {
      margin-top: 1rem;
      background-color: #2E1A46;
      color: #fff;
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="form-wrapper">

  <!-- Navbar -->
  <header class="navbar">
    <div class="nav-content">
      <img src="/static/img/image.png" alt="UJ JBS Logo" class="logo uj">
      <span class="nav-title">Form C – Researcher's Details</span>
      <div style="text-align: right;">
        <a href="{{url_for('logout')}}" class="btn-logout">Logout</a>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
<form  action="{{url_for('reject_or_Accept_form_c',id=formc.form_id)}}" method="POST" >
  <!-- Error Messages -->
            {% if messages %}
                <div id="alertMessage" class="alert alert-danger alert-dismissible fade show">
                    {% for message in messages %}
                        {{ message }}
                    {% endfor %}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endif %}

            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
       
   
      <h2>SECTION 1: Researcher's Details</h2>
      <label>Applicant Name
        <br><span>{{formc.applicant_name}}</span>
      </label>
      <label>Student/Staff Number
        <br><span>{{formc.student_number}}</span>
      </label>
      <label>Institution
        <br><span>{{formc.institution}}</span>
      </label>
      <label>UJ Department and School
        <br><span>{{formc.department}}</span>
      </label>
      <label>Degree Registered For
        <br><span>{{formc.degree}}</span>
      </label>
      <label>Title/Working Title of Study
        <br><span>{{formc.project_title}}</span>
      </label>
      <label>Mobile Number
        <br><span>{{formc.mobile_number}}</span>
      </label>
      <label>Email Address (Applicant)
        <br><span>{{formc.email_address}}</span>
      </label>
      <label>Supervisor(s)
        <br><span>{{formc.supervisor_name}}</span>
      </label>
      <label>Supervisor Email(s)
        <br><span>{{formc.supervisor_email}}</span>
      </label>

      
    
  </main>

  <!-- Section 2 -->

  <!-- Main Content -->
    <main class="main-content">



      <h2>SECTION 2: Risk Assessment</h2>

      <h4>2.1 Direct Involvement of Vulnerable Groups</h4>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Participant Group</th>
            <th>Tick if Applicable</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Communities that may be considered as vulnerable</td>
            <td>{{'YES' if formc.vulnerable else 'NO'}}</td></tr>
          <tr><td>People under the age of 18 or over 65</td>
            <td>{{'YES' if formc.age_under_18_or_over_65 else 'NO'}}</td></tr>
          <tr><td>UJ employees or students</td>
            <td>{{'YES' if formc.uj_employees else 'NO'}}</td></tr>
          <tr><td>Persons not usually considered vulnerable but would be in this context</td>
            <td>{{'YES' if formc.non_vulnerable_context else 'NO'}}</td></tr>
          <tr><td>Non-English-speaking participants</td>
            <td>{{'YES' if formc.non_english else 'NO'}}</td></tr>
          <tr><td>A researcher’s own students</td>
            <td>{{'YES' if formc.own_students else 'NO'}}</td></tr>
          <tr><td>People living in poverty</td>
            <td>{{'YES' if formc.poverty else 'NO'}}</td></tr>
          <tr><td>People with little or no education</td>
            <td>{{'YES' if formc.no_education else 'NO'}}</td></tr>
          <tr><td>Other: Please describe.</td>
            <td>{{formc.vulnerable_other_description}}</td></tr>
        </tbody>
      </table>
      
      <label><strong>Comments (e.g. “No participants”):</strong></label>
     
      
      <hr>

      <h4>2.2 Research Activity Type</h4>
<table class="table table-bordered">
  <thead>
    <tr>
      <th>Activity</th>
      <th>Tick if Applicable</th>
    </tr>
  </thead>
  <tbody>
  <tr><td>Collection/use/disclosure of info WITHOUT individual’s consent (excluding StatsSA, etc.)</td>
    <td>{{'YES' if formc.consent_violation else 'NO'}}</td></tr>
<tr><td>Causing discomfiture beyond normal inconvenience</td>
  <td>{{'YES' if formc.discomfiture else 'NO'}}</td></tr>
<tr><td>Deception of participants or covert observation</td>
  <td>{{'YES' if formc.deception else 'NO'}}</td></tr>
<tr><td>Examining sensitive or contentious issues</td>
  <td>{{'YES' if formc.sensitive_issues else 'YES'}}</td></tr>
<tr><td>Seeking prejudicial information about participants</td>
  <td>{{'YES' if formc.prejudicial_info else 'NO'}}</td></tr>
<tr><td>Using intrusive techniques</td>
  <td>{{'YES' if formc.intrusive else 'NO'}}</td></tr>
<tr><td>Study/participation in illegal activities</td>
  <td>{{'YES' if formc.illegal else 'NO'}}</td></tr>
<tr><td>Collecting personal/social info directly from participants</td>
  <td>{{'YES' if formc.direct_social_info else 'NO'}}</td></tr>
<tr><td>Identifiable info collected from available records (staff/student records)</td>
  <td>{{'YES' if formc.identifiable_records else 'NO'}}</td></tr>
<tr><td>Psychology inventories / scales / tests</td>
  <td>{{'YES' if formc.psychology_tests else 'NO'}}</td></tr>
<tr><td>Activities putting researcher/data collector at risk</td>
  <td>{{'YES' if formc.researcher_risk else 'NO'}}</td></tr>
    <tr><td>Other:  Please describe.</td>
      <td>{{formc.activity_other_description}}</td></tr>
  </tbody>
</table>

<label><strong>Comments:</strong></label>

      <hr>

      <h4>2.3 Additional Research Considerations</h4>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Item</th>
            <th>Tick if Applicable</th>
          </tr>
        </thead>
        <tbody>
       <tr><td>a) Reimbursement or incentives to any participants.</td>
        <td>{{'YES' if formc.incentives else 'NO'}}</td></tr>
        <tr><td>b) Participants will incur financial costs by participating.</td>
          <td>{{'YES' if formc.participant_costs else 'NO'}}</td></tr>
        <tr><td>c) Researcher has financial or other involvement in the research.</td>
          <td>{{'YES' if formc.researcher_interest else 'NO'}}</td></tr>
        <tr><td>d) Any potential conflict of interest (e.g., researching peers/students).</td>
          <td>{{'YES' if formc.conflict_of_interest else 'NO'}}</td></tr>
        <tr><td>e) Research is conducted on UJ premises.</td>
          <td>{{'YES' if formc.uj_premises else 'NO'}}</td></tr>
        <tr><td>f) Research uses UJ facilities (venues, software, hardware, etc.)</td>
          <td>{{'YES' if formc.uj_facilities else 'NO'}}</td></tr>
        <tr><td>g) Research is funded by UJ or through UJ-acquired funding.</td>
          <td>{{'YES' if formc.uj_funding else 'NO'}}</td></tr>
        
        </tbody>
      </table>
      
      <label><strong>Comments:</strong></label>
     
      
      <hr>
      
      <h5>Risk Assessment</h5>
      
      <label><strong>Rate your project risk level:</strong>
      <br><span>{{formc.risk_level}}</span></label>
    
      
      <br>
      <label><strong>Justify the Risk Level</strong>
      <br><span>{{formc.risk_justification}}</span></label>

      
      <label><strong>If Medium or High Risk, describe potential benefits:</strong>
      <br><span>{{formc.risk_benefits}}</span>
    </label>
     
      
      <label><strong>If Medium or High Risk, describe how risks will be mitigated:</strong>
      <br><span>{{formc.risk_mitigation}}</span></label>
  

  </main>

  <!-- section 3 -->

   <!-- Main Content -->
  <main class="main-content">



      <h2>SECTION 3: Proposal Summary Sheet</h2>

      <div class="form-group">
        <label for="project_title">3.1 Title or Provisional Title of the Research Project
          <br><span>{{formc.summary_title}}</span>
        </label>
       
      </div>

      <div class="form-group">
        <label for="executive_summary">3.2 Executive Summary of the Study
          <br><span>{{formc.executive_summary}}</span>
        </label>
      
      </div>

      <div class="form-group">
        <label for="research_questions">3.3 Research Questions / Hypotheses
          <br><span>{{formc.research_questions}}</span>
        </label>

      </div>

      <div class="form-group">
        <label for="research_purpose">3.4 Research Purpose and Objectives / Anticipated Outcomes
          <br><span>{{formc.research_purpose}}</span>
        </label>
        
      </div>

      <div class="form-group">
        <label for="secondary_data_info">3.5 Secondary Data: How was data originally collected, and ethical issues handled?
          <br><span>{{formc.secondary_data_info}}</span>
        </label>

      </div>

      <div class="form-group">
        <label for="exemption_reason">3.6 Why does your study meet exemption requirements?
          <br><span>{{formc.exemption_reason}}</span>
        </label>
     
      </div>

  
  </main>

  <!-- Section 4 -->

 <!-- Main Content -->
  <main class="main-content">

      <h2>SECTION 4: Declaration</h2>

      <p class="form-note">
        I, <strong> <u>{{formc.declaration_name}}</u> </strong>
        (full name of main researcher),declare that I have read the Policy on Research Ethics of UJ and the contents of this document are a true and accurate reflection of the methodological and ethical implications of my proposed study. I shall carry out the study in strict accordance with the approved proposal and the Policy on Research Ethics of UJ. I further undertake to inform the relevant research ethics review committee of JBS in writing of any adverse events that occur arising from the injury or harm experienced by the participants in the study. I shall also notify the relevant JBS research ethics review committee if any changes to the study are proposed. I shall maintain the confidentiality of all data collected from or about the research participants and impose strict controls in the maintenance of privacy. I shall record all data captured during interviews in accordance with
 
        ethical guidelines outlined in my proposal. Paragraph 5 of the Policy on Research Ethics places huge emphasis on the integrity of the research and I shall ensure that I conduct the research with the highest integrity taking into account UJ’s Policy for Copyright Infringement and Plagiarism. Data that was gathered retrospectively will not be used. I acknowledge that as main researcher it is my responsibility to ensure that the co-researchers to this research project adhere to the ethical principles set out in the UJ Policy on Research Ethics.
                                      

      </p>

      <div class="form-group">
        <label for="full_name"><strong>{{formc.full_name}}</strong></label>
      </div>

      <div class="form-group">
        <label for="submission_date"><span>{% if formc.submission_date%}{{formc.submission_date.strftime('%d/%m/%Y')}}{% endif%}</span></label>
      </div>
<hr>

         <div id="supervisorDeclaration" >
    
      <h3>SUPERVISOR'S SECTION</h3>
      <p><strong>Supervisor's Review and Declaration</strong></p>
    
      <div class="form-group">
        <label for="student_name">Student Name:</label>
        <span  id="student_name"  >{{formc.declaration_name}}</span>
      </div>

      <div class="form-group">
        <label for="submission_date">Date of Submission:</label>
        <span  id="submission_date" >{% if formc.submission_date%}{{formc.submission_date.strftime('%d/%m/%Y')}}{% endif%}</span>
      </div>

      <div class="form-group">
        <label for="supervisor_name">Supervisor Name:</label>
        <span  id="supervisor_name"  >{{formc.supervisor_name}}</span>
      </div>

      <div class="form-group">
        <label for="research_title">Title of Research:</label>
        <span  id="research_title" >{{formc.project_title}}</span>
      </div>

      <div class="form-group">
        <label for="supervisor_date">Date of Review:</label>
        <input type="date" class="form-control" id="supervisor_date" name="supervisor_date" required>
      </div>

      <h5 class="mt-4">Checklist of Required Documents for Supervisor Review</h5>

      <table class="table table-bordered mt-3">
        <thead class="thead-light">
          <tr>
            <th>Document</th>
            <th>Supervisor Comments</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Organisational Permission<br><small>Can be an email or formal letter. Ensure permission to access the organisation and relevant documents is included.</small></td>
            <td><textarea name="org_permission_comment" class="form-control" rows="3"></textarea></td>
          </tr>
          <tr>
            <td>Signed Waiver from Business<br><small>Template available under “Ethical Clearance Templates” in the system.</small></td>
            <td><textarea name="waiver_comment" class="form-control" rows="3"></textarea></td>
          </tr>
          <tr>
            <td>Ethics Application Form<br><small>Ensure all fields are complete and the form is co-signed by you as the supervisor. Any revisions made after your proposal review must be submitted.</small></td>
            <td><textarea name="form_a_comment" class="form-control" rows="3"></textarea></td>
          </tr>
          <tr>
            <td>Interview Questions and/or Questionnaire<br><small>Review for clarity, appropriateness, and ethical sensitivity. Preliminary versions may be accepted if noted.</small></td>
            <td><textarea name="questions_comment" class="form-control" rows="3"></textarea></td>
          </tr>
          <tr>
            <td>Participant Information Sheet and Informed Consent Form<br><small>Ensure the correct template has been used and tailored to the student’s study.</small></td>
            <td><textarea name="consent_comment" class="form-control" rows="3"></textarea></td>
          </tr>
          <tr>
            <td>Refined Concept Proposal<br><small>This should match the approved version with the literature review.</small></td>
            <td><textarea name="proposal_comment" class="form-control" rows="3"></textarea></td>
          </tr>
        </tbody>
      </table>

      <div class="form-group">
        <label for="supervisor_feedback"><strong>Supervisor Comments & Recommendation:</strong></label>
        <textarea class="form-control" id="supervisor_feedback" name="supervisor_feedback" rows="5" placeholder="Provide any feedback or required revisions..."></textarea>
      </div>

      <h5>Recommendation:</h5>
      <!-- Radio Buttons -->
  <div class="form-check">
    <input class="form-check-input" type="radio" name="recommendation" id="ready" value="Ready for submission" onchange="toggleFields()" required>
    <label class="form-check-label" for="ready">
      ✅ Ready for submission to JBS ETHICS ADMIN
    </label>
  </div>

  <div class="form-check mb-3">
    <input class="form-check-input" type="radio" name="recommendation" id="revisions" value="Revisions required" onchange="toggleFields()">
    <label class="form-check-label" for="revisions">
      ✏️ Revisions required before submission
    </label>
  </div>

  <!-- Accept Fields (initially hidden) -->
  <div id="acceptFields" style="display: none;">
    <div class="form-group">
      <label for="supervisor_signature">Supervisor Signature:</label>
      <input type="text" class="form-control" id="supervisor_signature" name="supervisor_signature">
    </div>

    <div class="form-group">
      <label for="signature_date">Date:</label>
      <input type="date" class="form-control" id="signature_date" name="signature_date">
    </div>

    <button type="submit" name="accept" value="Accept" class="btn btn-success">Submit to Ethics Admin</button>
  </div>

  <!-- Reject Button (initially hidden) -->
  <div id="rejectBtn" style="display: none;">
    <button type="submit" name="reject" value="Reject" class="btn btn-danger">Submit back to Student (Requires Submission)</button>
  </div>

</div>
   
    </form>



  </main>

  <footer class="footer">
    <p>&copy; 2025 Johannesburg Business School | JBS Ethics System</p>
  </footer>

</div>

<!-- SCRIPT: Confirmation Modal Logic -->
<script>
  const form = document.getElementById("formCDeclaration");
  const modal = document.getElementById("confirmationModal");
  const closeModalBtn = document.getElementById("closeModalBtn");

  form.addEventListener("submit", function (e) {
    e.preventDefault();
    modal.style.display = "flex";
  });

  closeModalBtn.addEventListener("click", () => {
    window.location.href = "supervisor-dashboard.html";
  });

  const supervisorDeclaration = document.getElementById("supervisorDeclaration");
  const submitToEthicsBtn = document.getElementById("submitToEthics");
  const submitToStudentBtn = document.getElementById("submitToStudent");

  // Show declaration when "Submit for Ethics Approval" is clicked
  submitToEthicsBtn.addEventListener("click", () => {
    supervisorDeclaration.style.display = "block";
  });

  // Hide declaration when "Return to Student" is clicked
  submitToStudentBtn.addEventListener("click", () => {
    supervisorDeclaration.style.display = "none";
  });

  // Simulate submission
  form.addEventListener("submit", function (e) {
    e.preventDefault();
    modal.style.display = "flex";
  });

  closeModalBtn.addEventListener("click", () => {
    window.location.href = "supervisor-dashboard.html";
  });


  function toggleFields() {
  const ready = document.getElementById("ready").checked;
  const revisions = document.getElementById("revisions").checked;

  const acceptFields = document.getElementById("acceptFields");
  const rejectBtn = document.getElementById("rejectBtn");

  const signature = document.getElementById("supervisor_signature");
  const date = document.getElementById("signature_date");

  if (ready) {
    acceptFields.style.display = "block";
    rejectBtn.style.display = "none";
    signature.required = true;
    date.required = true;
  } else if (revisions) {
    acceptFields.style.display = "none";
    rejectBtn.style.display = "block";
    signature.required = false;
    date.required = false;
    signature.value = '';
    date.value = '';
  } else {
    acceptFields.style.display = "none";
    rejectBtn.style.display = "none";
  }
}
</script>

</body>
</html>
